function [jacob, polyv, polyt] = tmpTenEval(x, pCoef, s)

m = zeros(79,1);
m(1) =x(2)*x(2);
m(2) =x(2)*x(3);
m(3) =x(2)*x(4);
m(4) =x(3)*x(3);
m(5) =x(3)*x(4);
m(6) =x(3)*x(5);
m(7) =x(4)*x(4);
m(8) =x(4)*x(5);
m(9) =x(2)*m(1);
m(10) =m(1)*x(3);
m(11) =m(1)*x(4);
m(12) =x(3)*m(2);
m(13) =m(2)*x(4);
m(14) =m(2)*x(5);
m(15) =m(2)*x(6);
m(16) =x(4)*m(3);
m(17) =m(3)*x(5);
m(18) =m(3)*x(6);
m(19) =x(6)*x(2)*x(5);
m(20) =x(3)*m(4);
m(21) =m(4)*x(4);
m(22) =m(4)*x(5);
m(23) =m(4)*x(6);
m(24) =x(4)*m(5);
m(25) =m(5)*x(5);
m(26) =m(5)*x(6);
m(27) =x(5)*m(6);
m(28) =m(6)*x(6);
m(29) =x(6)*x(3)*x(6);
m(30) =x(4)*m(7);
m(31) =m(7)*x(5);
m(32) =m(7)*x(6);
m(33) =x(5)*m(8);
m(34) =m(8)*x(6);
m(35) =x(6)*x(4)*x(6);
m(36) =x(5)*x(5)*x(5);
m(37) =x(6)*x(6)*x(6);
m(38) =m(9)*x(1);
m(39) =m(20)*x(1);
m(40) =m(30)*x(1);
m(41) =m(36)*x(1);
m(42) =m(37)*x(1);
m(43) =m(9)*x(2);
m(44) =m(9)*x(3);
m(45) =m(10)*x(3);
m(46) =m(10)*x(4);
m(47) =m(12)*x(3);
m(48) =m(12)*x(4);
m(49) =m(13)*x(4);
m(50) =m(20)*x(3);
m(51) =m(20)*x(4);
m(52) =m(21)*x(4);
m(53) =m(21)*x(5);
m(54) =m(21)*x(6);
m(55) =m(24)*x(4);
m(56) =m(24)*x(5);
m(57) =m(24)*x(6);
m(58) =m(25)*x(5);
m(59) =m(26)*x(6);
m(60) =m(30)*x(4);
m(61) =m(36)*x(5);
m(62) =m(37)*x(6);
m(63) =pCoef(2)*m(9)+pCoef(4)*m(11)+pCoef(7)*m(16)+pCoef(11)*m(30)+pCoef(12)*m(34);
m(64) =pCoef(3)*m(10)+pCoef(6)*m(13)+pCoef(10)*m(24);
m(65) =pCoef(5)*m(12)+pCoef(9)*m(21);
m(66) =pCoef(8)*m(20);
m(67) =pCoef(16)*m(9)+pCoef(18)*m(10)+pCoef(21)*m(12)+pCoef(24)*m(19)+pCoef(26)*m(22)+pCoef(27)*m(23)+pCoef(30)*m(27)+pCoef(31)*m(29)+pCoef(36)*m(36)+pCoef(37)*m(37);
m(68) =pCoef(19)*m(11)+pCoef(22)*m(13)+pCoef(28)*m(25)+pCoef(29)*m(26)+pCoef(34)*m(33)+pCoef(35)*m(35);
m(69) =pCoef(23)*m(16)+pCoef(32)*m(31)+pCoef(33)*m(32);
m(70) =pCoef(39)*m(9)+pCoef(41)*m(11)+pCoef(44)*m(16)+pCoef(45)*m(19)+pCoef(52)*m(31)+pCoef(53)*m(32)+pCoef(54)*m(33)+pCoef(55)*m(35)+pCoef(56)*m(36)+pCoef(57)*m(37);
m(71) =pCoef(40)*m(10)+pCoef(43)*m(13)+pCoef(48)*m(25)+pCoef(49)*m(26)+pCoef(50)*m(27)+pCoef(51)*m(29);
m(72) =pCoef(42)*m(12)+pCoef(46)*m(22)+pCoef(47)*m(23);
m(73) =pCoef(60)*m(18)+pCoef(64)*m(30)+pCoef(65)*m(31)+pCoef(66)*m(33);
m(74) =pCoef(62)*m(24)+pCoef(63)*m(25);
m(75) =pCoef(61)*m(21);
m(76) =pCoef(69)*m(17)+pCoef(73)*m(30)+pCoef(74)*m(32)+pCoef(75)*m(35);
m(77) =pCoef(71)*m(24)+pCoef(72)*m(26);
m(78) =pCoef(70)*m(21);
m(79) =pCoef(78);
polyv = zeros(6,1);
polyv(1) =x(3)*m(63)+x(3)*m(64)+x(3)*m(65)+x(3)*m(66)+pCoef(1)*m(43)+pCoef(13)*m(38)*x(2);
polyv(2) =x(4)*m(67)+x(4)*m(68)+x(4)*m(69)+pCoef(14)*m(43)+pCoef(15)*m(44)+pCoef(17)*m(45)+pCoef(20)*m(47)+pCoef(25)*m(50)+pCoef(38)*m(39)*x(3);
polyv(3) =x(3)*m(70)+x(3)*m(71)+x(3)*m(72)+pCoef(58)*m(60)+pCoef(59)*m(40)*x(4);
polyv(4) =x(3)*m(73)+x(3)*m(74)+x(3)*m(75)+pCoef(67)*m(61)+pCoef(68)*m(41)*x(5);
polyv(5) =x(3)*m(76)+x(3)*m(77)+x(3)*m(78)+pCoef(76)*m(62)+pCoef(77)*m(42)*x(6);
polyv(6) =x(2)*m(79)+pCoef(79)*x(3)+pCoef(80)*x(4)+pCoef(81)*x(5)+pCoef(82)*x(6)+pCoef(83);
jacob = zeros(6,6);
jacob(1,1) = pCoef(13)*m(43);
jacob(1,2) = pCoef(1)*4*m(9) + pCoef(2)*3*m(10) + pCoef(3)*2*m(12) + pCoef(4)*2*m(13) + pCoef(5)*m(20) + pCoef(6)*m(21) + pCoef(7)*m(24) + pCoef(13)*4*m(38);
jacob(1,3) =m(63)+2*m(64)+3*m(65)+4*m(66);
jacob(1,4) = pCoef(4)*m(10) + pCoef(6)*m(12) + pCoef(7)*2*m(13) + pCoef(9)*m(20) + pCoef(10)*2*m(21) + pCoef(11)*3*m(24) + pCoef(12)*m(28);
jacob(1,5) = pCoef(12)*m(26);
jacob(1,6) = pCoef(12)*m(25);
jacob(2,1) = pCoef(38)*m(50);
jacob(2,2) = pCoef(14)*4*m(9) + pCoef(15)*3*m(10) + pCoef(16)*3*m(11) + pCoef(17)*2*m(12) + pCoef(18)*2*m(13) + pCoef(19)*2*m(16) + pCoef(20)*m(20) + pCoef(21)*m(21) + pCoef(22)*m(24) + pCoef(23)*m(30) + pCoef(24)*m(34);
jacob(2,3) = pCoef(15)*m(9) + pCoef(17)*2*m(10) + pCoef(18)*m(11) + pCoef(20)*3*m(12) + pCoef(21)*2*m(13) + pCoef(22)*m(16) + pCoef(25)*4*m(20) + pCoef(26)*2*m(25) + pCoef(27)*2*m(26) + pCoef(28)*m(31) + pCoef(29)*m(32) + pCoef(30)*m(33) + pCoef(31)*m(35) + pCoef(38)*4*m(39);
jacob(2,4) =m(67)+2*m(68)+3*m(69);
jacob(2,5) = pCoef(24)*m(18) + pCoef(26)*m(21) + pCoef(28)*m(24) + pCoef(30)*2*m(25) + pCoef(32)*m(30) + pCoef(34)*2*m(31) + pCoef(36)*3*m(33);
jacob(2,6) = pCoef(24)*m(17) + pCoef(27)*m(21) + pCoef(29)*m(24) + pCoef(31)*2*m(26) + pCoef(33)*m(30) + pCoef(35)*2*m(32) + pCoef(37)*3*m(35);
jacob(3,1) = pCoef(59)*m(60);
jacob(3,2) = pCoef(39)*3*m(10) + pCoef(40)*2*m(12) + pCoef(41)*2*m(13) + pCoef(42)*m(20) + pCoef(43)*m(21) + pCoef(44)*m(24) + pCoef(45)*m(28);
jacob(3,3) =m(70)+2*m(71)+3*m(72);
jacob(3,4) = pCoef(41)*m(10) + pCoef(43)*m(12) + pCoef(44)*2*m(13) + pCoef(48)*m(22) + pCoef(49)*m(23) + pCoef(52)*2*m(25) + pCoef(53)*2*m(26) + pCoef(54)*m(27) + pCoef(55)*m(29) + pCoef(58)*4*m(30) + pCoef(59)*4*m(40);
jacob(3,5) = pCoef(45)*m(15) + pCoef(46)*m(20) + pCoef(48)*m(21) + pCoef(50)*2*m(22) + pCoef(52)*m(24) + pCoef(54)*2*m(25) + pCoef(56)*3*m(27);
jacob(3,6) = pCoef(45)*m(14) + pCoef(47)*m(20) + pCoef(49)*m(21) + pCoef(51)*2*m(23) + pCoef(53)*m(24) + pCoef(55)*2*m(26) + pCoef(57)*3*m(29);
jacob(4,1) = pCoef(68)*m(61);
jacob(4,2) = pCoef(60)*m(26);
jacob(4,3) =m(73)+2*m(74)+3*m(75);
jacob(4,4) = pCoef(60)*m(15) + pCoef(61)*m(20) + pCoef(62)*2*m(21) + pCoef(63)*m(22) + pCoef(64)*3*m(24) + pCoef(65)*2*m(25) + pCoef(66)*m(27);
jacob(4,5) = pCoef(63)*m(21) + pCoef(65)*m(24) + pCoef(66)*2*m(25) + pCoef(67)*4*m(36) + pCoef(68)*4*m(41);
jacob(4,6) = pCoef(60)*m(13);
jacob(5,1) = pCoef(77)*m(62);
jacob(5,2) = pCoef(69)*m(25);
jacob(5,3) =m(76)+2*m(77)+3*m(78);
jacob(5,4) = pCoef(69)*m(14) + pCoef(70)*m(20) + pCoef(71)*2*m(21) + pCoef(72)*m(23) + pCoef(73)*3*m(24) + pCoef(74)*2*m(26) + pCoef(75)*m(29);
jacob(5,5) = pCoef(69)*m(13);
jacob(5,6) = pCoef(72)*m(21) + pCoef(74)*m(24) + pCoef(75)*2*m(26) + pCoef(76)*4*m(37) + pCoef(77)*4*m(42);
jacob(6,2) =m(79);
jacob(6,3) = pCoef(79);
jacob(6,4) = pCoef(80);
jacob(6,5) = pCoef(81);
jacob(6,6) = pCoef(82);
polyt = zeros(6,1);
if(s<-1e-10)
	[Q, DQ] = tmpEvalQDQ(x);
	polyt = exp(s)*(polyv-Q);
	polyv = Q+polyt;
	jacob = DQ+exp(s)*(jacob-DQ);
end

end

function [Q, DQ] = tmpEvalQDQ(x)

a = [ (0.395600-0.918400i);  (0.829900-0.558000i);  (0.698200+0.715900i);  (0.855500-0.517800i);  (-0.673700-0.739000i); ];
b = [(0.818000+0.575200i); (-0.178100+0.984000i); (-0.956900-0.290300i); (0.964600-0.263800i); (0.975800-0.218800i); ];
L = [(0.628200+0.778000i); (-0.881600+0.472000i); (0.863100-0.505100i); (0.262100-0.965000i); (0.967800-0.251800i); ];
C = [(0.548400+0.836200i) (0.983000-0.183700i) (0.964000-0.265900i) (-0.995800+0.091800i) (0.310700-0.950500i) ];
xm_2=x(2:end).^3;
xm_1_b=x(2:end).*xm_2-b;
ax1_L=a.*(x(1)-L);
Q=ax1_L.*xm_1_b;
Q(6) = C*x(2:6)-1;
DQ = zeros(6);
for ia=1:5
	DQ(ia, ia+1) = 4*ax1_L(ia)*xm_2(ia);
end
DQ(1:5, 1) = a.*xm_1_b;
DQ(6,2:6)=C;
end

